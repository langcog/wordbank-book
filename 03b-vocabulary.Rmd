# Demographic Variables {#demographics}

Chapter \@ref{vocab} examined differences across languages in the distribution of children's reported vocabulary.  In this chapter, we follow up these analyses by beginning the process -- which will span throughout the book -- of attempting to understand the nature and sources of these differences. In particular, we take advantage of the sample diversity described in Chapter \@ref{methods} to explore differences in the median trajectory of vocabulary growth within demographic groups, focusing on three variables that are relatively available in our data: sex, maternal education, and birth order, and develop a framework for comparing the magnitude of these effects.

One important tension in this chapter reflects many earlier discussions of variability in CDI scores [from @fenson1994, @feldman200, and @erikkson2012, among others]. While some demographic differences in vocabulary are quite consistent -- substantially so, as it turns out -- the overall proportion of variance in vocabulary that they capture is still relatively limited. This point is a generalization of 

```{r 3b_vocab_admins}
num_words <- items %>%
  filter(type == "word") %>%
  group_by(language, form) %>%
  summarise(n = n())

vocab_data <- admins %>%
  dplyr::select(data_id, language, form, age, sex, 
                mom_ed, birth_order, production, comprehension) %>% 
  left_join(num_words) %>%
  mutate(no_production = n - production)

min_age <- min(vocab_data$age)
max_age <- max(vocab_data$age)
```

## Gender

<!-- s (Bauer, Goldfield, & Reznick, 2002; Feldman et al., 2000; Fenson et al., 1994; Huttenlocher, Haight, Bryk, Seltzer, Lyons, 1991; Van Hulle, Goldsmith, & Lemery, 2004):  -->

Our first analysis examines how vocabulary development differs by children's reported gender, replicating and extending the results of @eriksson2012.^[An earlier version of this analysis was reported in @frank2016.]

WG production
```{r 3_gender_plot_WG_prod}
wg_sex_data <- vocab_data %>%
  filter(!is.na(sex), form == "WG") %>%
  mutate(no_comprehension = n - comprehension)

wg_sex_means <- wg_sex_data %>%
  group_by(language, sex, age) %>%
  summarise(median = median(production/n))

wg_sex_models <- wg_sex_data %>%
  split(.$language) %>%
  map(function(x) {
    robustbase::glmrob(cbind(production, no_production) ~ age * sex - sex,
                       family = "binomial",
                       data = x)
  })

wg_sex_preds <- expand.grid(language = unique(wg_sex_means$language),
                            age = min_age:max_age,
                            sex = unique(sex_means$sex)) %>%
  split(.$language) %>%
  map_df(function(x) {
    x$pred <- predict(wg_sex_models[[x$language[1]]],
                      newdata = x, type = "response")
    return(x)
  })

ggplot(wg_sex_means,
       aes(x = age, y = median, colour = sex, label = sex)) +
  facet_wrap(~language) +
  geom_point(alpha=.2) +
  geom_line(data = wg_sex_preds, aes(y = pred)) +
  scale_colour_solarized(name="Sex") +
  scale_x_continuous(breaks = seq(8,
                                  max(wg_sex_means$age), 4),
                     limits = c(min(wg_sex_means$age), 20),
                     name = "Age (months)") +
  ylab("Median Comprehension Vocabulary (proportion of total words)") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")
```

WG Comprehension. Note that many authors do not find comprehension gender differences (e.g., @erikkson2012 using overlapping data, @feldman2000 using a large, different dataset of CDI for low-income).

```{r 3_gender_plot_WG}
wg_sex_data <- vocab_data %>%
  filter(!is.na(sex), form == "WG") %>%
  mutate(no_comprehension = n - comprehension)

wg_sex_means <- wg_sex_data %>%
  group_by(language, sex, age) %>%
  summarise(median = median(comprehension/n))

wg_sex_models <- wg_sex_data %>%
  split(.$language) %>%
  map(function(x) {
    robustbase::glmrob(cbind(comprehension, no_comprehension) ~ age * sex - sex,
                       family = "binomial",
                       data = x)
  })

wg_sex_preds <- expand.grid(language = unique(sex_means$language),
                            age = min_age:max_age,
                            sex = unique(sex_means$sex)) %>%
  split(.$language) %>%
  map_df(function(x) {
    x$pred <- predict(wg_sex_models[[x$language[1]]],
                      newdata = x, type = "response")
    return(x)
  })

ggplot(wg_sex_means,
       aes(x = age, y = median, colour = sex, label = sex)) +
  facet_wrap(~language) +
  geom_point(alpha=.2) +
  geom_line(data = wg_sex_preds, aes(y = pred)) +
  scale_colour_solarized(name="Sex") +
  scale_x_continuous(breaks = seq(min(wg_sex_means$age),
                                  max(wg_sex_means$age), 4),
                     limits = c(min(wg_sex_means$age), max(wg_sex_means$age)),
                     name = "Age (months)") +
  ylab("Median Comprehension Vocabulary (proportion of total words)") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")
```

Plot vocabulary size over age by gender for WS production.

```{r 3_gender_plot}
sex_data <- vocab_data %>%
  filter(!is.na(sex), form == "WS")

sex_means <- sex_data %>%
  group_by(language, sex, age) %>%
  summarise(median = median(production/n))

fit_sex <- function(x) {
  robustbase::glmrob(cbind(production, no_production) ~ age * sex - sex,
                     family = "binomial",
                     data = x)
}

pred_sex <- function(x) {
  x$pred <- predict(sex_models[[x$language[1]]],
                    newdata = x, type = "response")
  return(x)
}

sex_models <- sex_data %>%
  split(.$language) %>%
  map(fit_sex)

sex_preds <- expand.grid(language = unique(sex_means$language),
                         age = min_age:max_age,
                         sex = unique(sex_means$sex)) %>%
  split(.$language) %>%
  map_df(pred_sex)

ggplot(sex_means,
       aes(x = age, y = median, colour = sex, label = sex)) +
  facet_wrap(~language) +
  geom_point(alpha=.2) +
  geom_line(data = sex_preds, aes(y = pred)) +
  scale_colour_solarized(name="Sex") +
  scale_x_continuous(breaks = seq(min(sex_means$age),
                                  max(sex_means$age), 4),
                     limits = c(min(sex_means$age), max(sex_means$age)),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary (proportion of total words)") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")
```

We quantify the gap between boys and girls in effect size. Normally we'd use something like Cohen's $d$ here, where

$$d = \frac{\mu_2 - \mu_1}{SD_{pooled}}$$

But as in the previous chapter, we have the problem of non-normal distributions. To circumvent this, we use a non-parametric measure derived from the same components. It's going to be the difference between medians, divided by the MAD. (We call this the MMAD).

The MMAD for gender is quite constant across age.

```{r 3b_gender_mmad}
gender_mmad_ratio <- vocab_data %>%
  group_by(language, form, age, sex) %>%
  filter(n() > 10) %>%
  summarise(median_prod = median(production),
            mad_prod = mad(production),
            n = n()) %>%
  group_by(language, form, age) %>%
  filter(n() == 2) %>% # more than 2 in each gender group
  summarise(mmad = (median_prod[sex == "Female"] - median_prod[sex == "Male"]) / mean(mad_prod)) %>%
  filter(is.finite(mmad)) 

ggplot(gender_mmad_ratio,
       aes(x = age, y = mmad, col = language)) +
  geom_jitter() +
  geom_smooth(span = 1, aes(group = 1)) +
  scale_color_solarized()
```

Visualize variability. 

```{r}
gender_mmad_summary <- gender_mmad_ratio %>%
  group_by(language) %>%
  summarise(mmad_mean = mean(mmad), 
            mmad_var = var(mmad),
            mmad_ci_lower = mean(mmad) - ci.t(mmad),
            mmad_ci_upper = mean(mmad) + ci.t(mmad), 
            n = n()) %>%
  filter(n > 4) # more than four age points - FIXME, arbitrary

ggplot(gender_mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("Language") + 
  xlab("MADM (Comprehension)") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") + 
  geom_hline(aes(yintercept = 1), lty = 2, color = "gray")


```

We use a fixed-effects meta-analysis to pool these estimates. Fixed-effects could be warranted because the instruments are relatively close to one another, but given the general issues of sampling and administration variability, we choose random effects. We also compute variances across age samples, which is at best conservative and potentially not correct (as it substitutes age variability for measurement variability). 

```{r}
gender_ma <- rma(yi = mmad_mean, vi = mmad_var, slab = language, data = gender_mmad_summary, method = "REML")
summary(gender_ma)
```


These measurements suggest a meta-analytic gender difference of `r round(gender_ma$beta[1], 2)`.

Do these differences reflect differences in measurement that are unique to the CDI? One way of addressing this question is to examine other studies of gender differences that have been found in other studies. Unfortunately, many of the studies reporting differences themselves rely on the CDI, likely for the reasons reviewed in Chapter \@ref(intro), e.g. [@bauer2002,@fenson1994,@feldman2000]

@feldman2000 finds no effect in comprehension but uses CDIs with a distinct dataset of low-income American English speakers arounsd 24 months and finds a production difference ($N= 2156$, $d = .35$).

A seminal study by @huttenlocher1991 measured gender effects in vocabulary size as estimated from a naturalistic sample of production and found substantial differences in vocabulary growth favoring girls. Although the measurements from this study are not comparable, the effects are quite large (and are relatively unaffected by controlling for maternal language exposure). 


```{r}
b2012 <- read_csv("data/bornstein2012/bornstein2012_combined.csv")
nrow(b2012)

qplot(z_20, z_48, col = gender, pch = gender, data = b2012) +
  scale_color_solarized() + 
  xlab("Standardized Language at 20 Months") + 
  ylab("Standardized Language at 48 Months") + 
  geom_smooth(method = "lm")

b2012_summary <- b2012 %>%
  group_by(gender) %>%
  do(data.frame(rbind(smean.cl.boot(.$z_20))))
```

@bornstein2012 use a particularly powerful study design to examine stability in early language estimates across many different measures (including a precursor to the CDI as well as several standardized and naturalistic sampling measures). We digitized data from their Figure 2 to examine the size of the gender differences in the latent vocabulary construct that they recovered (NOTE these data are not perfect, I have double-digitized one point). As these scores are standardized, we can examine the difference in means and recover the standardized effect size for gender in the data, which is `r round(-diff(b2012_summary$Mean), 2)` standard deviations. Since this measurement is *greater* than that found in the CDI measurements for our study (the comparable American English measurement was `r round(filter(gender_mmad_summary, language == "English (American)") %>% pull(mmad_mean), 2)`), we doubt that this effect is due soley to reporting bias. 

### Explanations

Fetal testosterone. @lutchmaya2001 used CDI meausures and recovered a similar effect ($d = .64$ at 18 months with $N=87), and $d = .60$ at 24 months for a subsample). They found some relationship with fetal testosterone across sexes, but it did not hold up within sex (perhaps due to small samples). 

## Maternal education

From health to education, children from lower socioeconomic status (SES) backgrounds tend to be at higher risk for a variety of negative developmental outcomes, compared to their higher-SES peers (Bradley & Corwin, 2002). A large literature documents specific relations between SES and children’s early language abilities, especially oral vocabulary, which is in turn related to outcomes when children begin formal education (e.g., Durham et al., 2007; Hart & Risley, 2006; Hoff, 2002; Marchman & Fernald, 2008). Environmental explanations of these SES effects are often given in terms of indirect factors that affect life opportunities or experiences, such as nutrition and access to health care, as well as more direct factors that impact daily life, such as smoking during pregnancy, access to quality child care, or amount of time caregivers spend in interactions with their young children. Alternatively, even early language shows a significant genetic component, raising the possibility that SES-vocabulary links may instead be genetically mediated (Hayiou-Thomas et al., 2012). 

Cross-national comparisons may shed light on the factors that lead to relations between SES and children’s vocabulary outcomes. On the one hand, relatively constant relations across language communities that vary widely in indirect and direct factors that shape learning would provide prima facie support for genetic explanations. In contrast, a greater degree of cross-national variability would point to the origins of SES effects in aspects of children’s early environments that vary with SES to differing degrees across countries (e.g., Siddiqi et al., 2007; L. C. H. Fernald et al., 2012). Our current study addresses this issue in very young children using data from the MacArthur-Bates Communicative Development Inventories (MB-CDI), a family of reliable and valid parent-report instruments for measuring early vocabulary development in children under 3 years (Fenson et al., 2007). We take advantage of Wordbank, a new database of more than 10,000 MB-CDI instruments from six countries (Frank et al., 2016).  We use maternal education as a proxy for SES, following previous work suggesting that maternal education is strongly related to SES variation (Bornstein et al., 2003; Hoff, 2002). 


@arriaga2000

We use maternal education as a proxy for socio-economic status.

```{r 3_mom_ed_wg}
wg_ses_data <- vocab_data %>%
  filter(!is.na(mom_ed), form == "WG") %>%
  mutate(mom_ed = fct_collapse(mom_ed,
                               `Below Secondary` = c("None","Primary",
                                                     "Some Secondary"),
                               `Secondary` = c("Secondary", "Some College"),
                               `College and Above` = c("College",
                                                       "Some Graduate",
                                                       "Graduate")), 
         no_comprehension = n - comprehension)

wg_ses_means <- wg_ses_data %>%
  group_by(language, mom_ed, age) %>%
  summarise(median = median(comprehension/n))

wg_ses_models <- wg_ses_data %>%
  split(.$language) %>%
  map( function(x) {
    robustbase::glmrob(cbind(comprehension, no_comprehension) ~
                         age * mom_ed  - mom_ed,
                       family = "binomial",
                       data = x)
  })

wg_ses_preds <- expand.grid(language = unique(wg_ses_means$language),
                            age = min_age:max_age,
                            mom_ed = unique(wg_ses_means$mom_ed)) %>%
  split(.$language) %>%
  map_df(function(x) {
    x$pred <- predict(wg_ses_models[[x$language[1]]],
                      newdata = x, type = "response")
    return(x)
  })

ggplot(wg_ses_means,
       aes(x = age, y = median, colour = mom_ed, label = mom_ed)) +
  facet_wrap(~language) +
  geom_point(alpha=.2) +
  geom_line(data = wg_ses_preds, aes(y = pred)) +
  scale_colour_solarized(name="Maternal Education") +
  scale_x_continuous(breaks = seq(min(wg_ses_means$age),
                                  max(wg_ses_means$age), 4),
                     limits = c(min(wg_ses_means$age), max(wg_ses_means$age)),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary (proportion of total words)") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")
```

WS Production

```{r 3_mom_ed_ws}
ses_data <- vocab_data %>%
  filter(!is.na(mom_ed), form == "WS") %>%
  mutate(mom_ed = fct_collapse(mom_ed,
                               `Below Secondary` = c("None","Primary",
                                                     "Some Secondary"),
                               `Secondary` = c("Secondary", "Some College"),
                               `College and Above` = c("College",
                                                       "Some Graduate",
                                                       "Graduate")))

ses_means <- ses_data %>%
  group_by(language, mom_ed, age) %>%
  summarise(median = median(production/n))

fit_ses <- function(x) {
  robustbase::glmrob(cbind(production, no_production) ~
                       age * mom_ed  - mom_ed,
                     family = "binomial",
                     data = x)
}

pred_ses <- function(x) {
  x$pred <- predict(ses_models[[x$language[1]]],
                    newdata = x, type = "response")
  return(x)
}

ses_models <- ses_data %>%
  split(.$language) %>%
  map(fit_ses)

ses_preds <- expand.grid(language = unique(ses_means$language),
                         age = min_age:max_age,
                         mom_ed = unique(ses_means$mom_ed)) %>%
  split(.$language) %>%
  map_df(pred_ses)

ggplot(ses_means,
       aes(x = age, y = median, colour = mom_ed, label = mom_ed)) +
  facet_wrap(~language) +
  geom_point(alpha=.2) +
  geom_line(data = ses_preds, aes(y = pred)) +
  scale_colour_solarized(name="Maternal Education") +
  scale_x_continuous(breaks = seq(min(ses_means$age),
                                  max(ses_means$age), 4),
                     limits = c(min(ses_means$age), max(ses_means$age)),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary (proportion of total words)") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")
```

```{r 3b_ses_mmad}
ses_mmad_ratio <- ses_data %>%
  group_by(language, form, age, mom_ed) %>%
  filter(n() > 5) %>% # FIXME - arbirtary
  summarise(median_prod = median(production),
            mad_prod = mad(production),
            n = n()) %>%
  group_by(language, form, age) %>%
  filter(sum(mom_ed == "College and Above") > 0, 
         sum(mom_ed == "Secondary") > 0) %>% # more than 2 in each gender group
  summarise(mmad = (median_prod[mom_ed == "College and Above"] - 
                      median_prod[mom_ed == "Secondary"]) / mean(mad_prod)) %>%
  filter(is.finite(mmad)) 

ggplot(ses_mmad_ratio,
       aes(x = age, y = mmad, col = language)) +
  geom_jitter() +
  geom_smooth(span = 1, aes(group = 1)) +
  scale_color_solarized()
```

Visualize variability. 

```{r}
ses_mmad_summary <- ses_mmad_ratio %>%
  group_by(language) %>%
  summarise(mmad_mean = mean(mmad), 
            mmad_ci_lower = mean(mmad) - ci.t(mmad),
            mmad_ci_upper = mean(mmad) + ci.t(mmad), 
            n = n()) %>%
  filter(n > 4) # more than four age points - FIXME, arbitrary

ggplot(ses_mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("Language") + 
  xlab("MMAD") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") + 
  geom_hline(aes(yintercept = 1), lty = 2, color = "gray")
```

### Explanations

Our findings show that the relations between maternal education and children’s vocabulary outcomes is highly variable across countries. The observational nature of our data precludes strong inferences about the precise factors that lead to these differences, though speculation is certainly possible. The large magnitude of the differences across countries suggests a powerful role for environmental factors in shaping variation in child outcomes even before the age of 3 years. Findings from the present study support the proposal that inequalities in factors that are linked to child well being should be addressed early in life. Since features of the quantity and quality of caregiver linguistic input has been strongly implicated in early language development, future research should focus on policy interventions that facilitate children’s access to  high quality talk by caregivers, including care availability and parental leave. 

### Reporting biases

> The data suggest that different scales of the CDI may be susceptible to differential reporting biases in different subgroups of the population. On CDI sec- tions that require considerable subjective interpreta- tion of observations, parents with low educational and income levels, who were underrepresented in the CDI norming sample, seem to overestimate their child’s abilities in comparison with parents with more education and income. For example, the Phrase and Vocabulary Comprehension sections of the CDI-WG require parents to make potentially difficult judg-
ments about their children’s levels of understanding. Negative correlations were found between scores on both of these sections and maternal education and health insurance status. Parents in general may have difficulty in distinguishing between comprehension that is based solely on verbal input and comprehen- sion that is based on a variety of nonlinguistic cues and contextual supports to meaning (Chapman, 1978). Some parents may recall times when the words were used in the child’s presence and may confuse ex- posure with understanding. Some may credit the child with comprehension if the child seems to under- stand the word in a highly constrained situation. These difficulties may explain why parental reports of verbal comprehension in this age range are higher than results of direct testing (Tomasello & Mervis 1994). They also may explain why correlations be- tween parental reports and comprehension scores from other methods are extremely low (Reznick, 1990). 

One discussion in @feldman2000 and @fenson1993 is that there may be reporting biases, particularly in comprehension, for children in the youngest age groups. 

@reznick1990 also found a negative correlation between SES and vocabulary in a subgroup analysis.

We examine reported comprehension vocabulary 

```{r}
early_comprehension <- wg_ses_data %>%
  filter(age < 13) %>%
  group_by(language, mom_ed, age) %>%
  summarise(median = median(comprehension / n), 
            n = n())

ggplot(early_comprehension, 
       aes(x = age, y = median, col = mom_ed)) + 
  geom_point(aes(size = n), position = "dodge") + 
  facet_wrap(~language) + 
  scale_color_solarized() +
  geom_smooth(se=FALSE, span = 2)
  # geom_smooth(method = "lm", se = FALSE, formula = y ~ x)
```


## Birth order

Only `r length(unique(filter(vocab_data,!is.na(birth_order))$language))` languages have birth order data, and only `r length(unique(filter(vocab_data,!is.na(birth_order), form == "WS")$language))` languages have it for WS.

```{r 3_birth_order}
ord_data <- vocab_data %>%
  filter(!is.na(birth_order), form == "WS") %>%
  filter(language != "Spanish") %>% # FIXME - birth order data wacky
  mutate(birth_order = fct_collapse(birth_order,
                                    "Third+" = c("Third","Fourth",
                                                 "Fifth","Sixth",
                                                 "Seventh","Eighth")))

ord_means <- ord_data %>%
  group_by(language, birth_order, age) %>%
  summarise(median = median(production/n))

fit_ord <- function(x) {
  robustbase::glmrob(cbind(production, no_production) ~
                       age * birth_order  - birth_order,
                     family = "binomial",
                     data = x)
}

pred_ord <- function(x) {
  x$pred <- predict(ord_models[[x$language[1]]],
                    newdata = x, type = "response")
  return(x)
}

ord_models <- ord_data %>%
  split(.$language) %>%
  map(fit_ord)

ord_preds <- expand.grid(language = unique(ord_means$language),
                         age = min_age:max_age,
                         birth_order = unique(ord_means$birth_order)) %>%
  split(.$language) %>%
  map_df(pred_ord)


ggplot(ord_means,
       aes(x = age, y = median, colour = birth_order,
           label = birth_order)) +
  facet_wrap( ~language) +
  geom_point(alpha=.2) +
  geom_line(data = ord_preds, aes(y = pred)) +
  scale_colour_solarized(name="Birth Order") +
  scale_x_continuous(breaks = seq(min(ord_means$age),
                                  max(ord_means$age), 4),
                     limits = c(min(ord_means$age), max(ord_means$age)),
                     name = "Age (months)") +
  ylab("Median Productive Vocabulary (proportion of total words)") +
  ylim(c(0, 1)) +
  theme(legend.position = "bottom")
```

```{r 3b_ord_mmad}
bo_mmad_ratio <- ord_data %>%
  group_by(language, form, age, birth_order) %>%
  filter(n() > 5) %>% # FIXME - arbirtary
  summarise(median_prod = median(production),
            mad_prod = mad(production),
            n = n()) %>%
  group_by(language, form, age) %>%
  filter(sum(birth_order == "First") > 0, 
         sum(birth_order == "Second") > 0) %>% # more than 2 in each gender group
  summarise(mmad = (median_prod[birth_order == "First"] - 
                      median_prod[birth_order == "Second"]) / mean(mad_prod)) %>%
  filter(is.finite(mmad)) 

ggplot(bo_mmad_ratio,
       aes(x = age, y = mmad, col = language)) +
  geom_jitter() +
  geom_smooth(span = 1, aes(group = 1)) +
  scale_color_solarized()
```

Visualize variability. 

```{r}
bo_mmad_summary <- bo_mmad_ratio %>%
  group_by(language) %>%
  summarise(mmad_mean = mean(mmad), 
            mmad_ci_lower = mean(mmad) - ci.t(mmad),
            mmad_ci_upper = mean(mmad) + ci.t(mmad), 
            n = n()) %>%
  filter(n > 4) # more than four age points - FIXME, arbitrary

ggplot(bo_mmad_summary, aes(x = language, y = mmad_mean)) + 
  geom_pointrange(aes(ymin = mmad_ci_lower, ymax = mmad_ci_upper)) + 
  # ylim(0,1.5) + 
  coord_flip() + 
  ylab("Language") + 
  xlab("MMAD") +
  geom_hline(aes(yintercept = 0), lty = 2, color = "gray") + 
  geom_hline(aes(yintercept = 1), lty = 2, color = "gray")
```

Synthesize


```{r}
gender <- gender_mmad_summary %>%
  summarise(cv =  sd(mmad_mean) / mean(mmad_mean))

ses <- ses_mmad_summary %>%
  summarise(cv =  sd(mmad_mean) / mean(mmad_mean))

bo <- bo_mmad_summary %>%
  summarise(cv =  sd(mmad_mean) / mean(mmad_mean))

cvs <- data_frame(measure = c("Female advantage", 
                              "College advantage", 
                              "First-born advantage"), 
                  cv = c(gender$cv, ses$cv, bo$cv))

write_feather(cvs, "data/cvs/demographic_cvs.feather")
```

## ABC method

Another  way to get effect sizes is to integrate the area between curves.

The units for this analysis are arbitrary and (right now) can't be compared across languages, since the curves have different lengths. To overcome this limitation, we'd need to look at

```{r 3_effect_size}
momed_levels <- levels(ses_means$mom_ed)

ses_abc <- ses_preds %>%
  spread(mom_ed, pred) %>%
  group_by(language) %>%
  summarise(mom_secondary_ed = sum(`Secondary` -
                                     `Below Secondary`, na.rm=TRUE),
            mom_college_ed = sum(`College and Above` -
                                   `Secondary`, na.rm=TRUE))

sex_abc <- sex_preds %>%
  spread(sex, pred) %>%
  group_by(language) %>%
  summarise(female = sum(Female - Male, na.rm=TRUE))

ord_abc <- ord_preds %>%
  spread(birth_order, pred) %>%
  group_by(language) %>%
  summarise(firstborn = sum(`First` - `Second`, na.rm=TRUE),
            secondborn = sum(`Second` - `Third+`, na.rm=TRUE))

abcs <- left_join(sex_abc, ord_abc) %>%
  left_join(ses_abc) %>%
  gather(demographic, area_diff, female, firstborn, secondborn,
         mom_secondary_ed, mom_college_ed) %>%
  mutate(demographic = fct_relevel(demographic,
                                   c("female", "firstborn",
                                     "secondborn", "secondary",
                                     "college")))
```

First look at gender advantage.

```{r 3_gender_advantage}
ggplot(filter(abcs, demographic == "female"),
       aes(x = fct_reorder(language, area_diff), y = area_diff)) +
  geom_point() +
  coord_flip() +
  ylab("Advantage for demographic characteristic") +
  xlab("") +
  ylim(c(0, 2.5)) +
  theme(legend.position = "bottom")
```

From this perspective it is quite clear that the Italian effect is anomalous. FIXME: what do we say about this?

Visualizing demographic advantages against one another.

```{r 3_demographic_advantages}
# n_missing <- abcs %>%
#   group_by(language) %>%
#   summarise(n_missing = sum(is.na(area_diff)))

# plot_data <- left_join(abcs, n_missing) %>% 

ggplot(abcs,
       aes(x = language,
           group = demographic, col = demographic,
           y = area_diff)) +
  geom_point() +
  facet_grid(~demographic) + 
  coord_flip() + 
  ylab("Advantage for demographic characteristic") +
  xlab("") +
  ylim(c(0, 4)) +
  theme(legend.position = "bottom")
```

## Are languages truly different, controlling for demographics

We observed that the mena
